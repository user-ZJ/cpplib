===============================
TOP命令使用
===============================

top命令显示
==============
.. image:: /images/top.png

统计区域信息
--------------

+--------------------+-------------------------------+---------------------------------------------------------------------------------------------------------------------+
|         行         |           显示信息            |                                                        说明                                                         |
+====================+===============================+=====================================================================================================================+
| 第一行             | - 17:17:14                    | - 当前时间                                                                                                          |
|                    | - up 7 days,2:34              | - 表示系统运行时间                                                                                                  |
|                    | - 0 users                     | - 当前登录用户数                                                                                                    |
|                    | - load average:0.00 0.00 0.00 | - 系统负载，即任务队列的平均长度；三个数值分别为 1分钟、5分钟、15分钟前到现在的平均值(现代操作系统中任务单位为线程) |
+--------------------+-------------------------------+---------------------------------------------------------------------------------------------------------------------+
| 第二行             |                               | 总共有8个进程，1个正在运行，7个睡眠进程，0个停止的进程，0个僵尸进程                                                 |
| (进程信息)         |                               |                                                                                                                     |
+--------------------+-------------------------------+---------------------------------------------------------------------------------------------------------------------+
| 第三行(CPU信息)    | - us                          | - 用户空间占用CPU百分比                                                                                             |
|                    | - sy                          | - 内核空间占用CPU百分比                                                                                             |
|                    | - ni                          | - 用户进程空间内改变过优先级的进程占用CPU百分比                                                                     |
|                    | - id                          | - 空闲CPU百分比                                                                                                     |
|                    | - wa                          | - 等待输入输出的CPU时间百分比                                                                                       |
|                    | - hi                          | - 服务硬件中断所花费的时间                                                                                          |
|                    | - si                          | - 服务软件中断所花费的时间                                                                                          |
|                    | - st                          | - 虚拟 CPU 等待实际 CPU 的时间的百分比,高st值可能意味着主机供应商在服务器上过量地出售虚拟机                         |
+--------------------+-------------------------------+---------------------------------------------------------------------------------------------------------------------+
| 第四行(内存信息)   | - total                       | - 物理内存总量                                                                                                      |
|                    | - used                        | - 使用的物理内存总量                                                                                                |
|                    | - free                        | - 空闲内存总量                                                                                                      |
|                    | - buff/cache                  | - 用作内核缓存的内存量                                                                                              |
+--------------------+-------------------------------+---------------------------------------------------------------------------------------------------------------------+
| 第五行(交换区信息) | - total                       | - 交换区总量                                                                                                        |
|                    | - used                        | - 使用的交换区总量                                                                                                  |
|                    | - free                        | - 空闲交换区总量                                                                                                    |
|                    | - avail                       | - free+cache                                                                                                        |
+--------------------+-------------------------------+---------------------------------------------------------------------------------------------------------------------+

进程信息区
-------------

**默认情况下仅显示比较重要的 PID、USER、PR、NI、VIRT、RES、SHR、S、%CPU、%MEM、TIME+、COMMAND 列。可通过 f 键可以选择显示的内容**

+----------+-------------------------------------------------------------------------+
| 显示信息 |                                  说明                                   |
+==========+=========================================================================+
| PID      | 进程ID                                                                  |
+----------+-------------------------------------------------------------------------+
| USER     | 用户                                                                    |
+----------+-------------------------------------------------------------------------+
| PR       | 优先级                                                                  |
+----------+-------------------------------------------------------------------------+
| NI       | nice值，负值表示高优先级，正值表示低优先级                              |
+----------+-------------------------------------------------------------------------+
| VIRT     | 进程使用的虚拟内存总量，单位kb。VIRT=SWAP+RES                           |
+----------+-------------------------------------------------------------------------+
| RES      | 进程使用的、未被换出的物理内存大小，单位kb。RES=CODE+DATA               |
+----------+-------------------------------------------------------------------------+
| SHR      | 共享内存大小，单位kb                                                    |
+----------+-------------------------------------------------------------------------+
| S        | 进程状态；D=不可中断的睡眠状态，R=运行，S=睡眠，T=跟踪/停止，Z=僵尸进程 |
+----------+-------------------------------------------------------------------------+
| %CPU     | 上次更新到现在的CPU时间占用百分比                                       |
+----------+-------------------------------------------------------------------------+
| %MEM     | 进程使用的物理内存百分比                                                |
+----------+-------------------------------------------------------------------------+
| TIME+    | 进程使用的CPU时间总计，单位1/100秒                                      |
+----------+-------------------------------------------------------------------------+
| COMMAND  | 命令名/命令行                                                           |
+----------+-------------------------------------------------------------------------+

命令行参数
---------------
    | top [-] [d] [p] [q] [c] [C] [S] [s] [n]

+--------+--------------------------------------------------------------------------------------------------+
|  参数  |                                               说明                                               |
+========+==================================================================================================+
| -d num | 指定每两次屏幕信息刷新之间的时间间隔。当然用户可以使用s交互命令来改变                            |
+--------+--------------------------------------------------------------------------------------------------+
| -p pid | 通过指定监控进程ID来仅仅监控某个进程的状态                                                       |
+--------+--------------------------------------------------------------------------------------------------+
| -q     | 该选项将使top没有任何延迟的进行刷新。如果调用程序有超级用户权限，那么top将以尽可能高的优先级运行 |
+--------+--------------------------------------------------------------------------------------------------+
| -S     | 指定累计模式                                                                                     |
+--------+--------------------------------------------------------------------------------------------------+
| -s     | 使top命令在安全模式中运行。这将去除交互命令所带来的潜在危险                                      |
+--------+--------------------------------------------------------------------------------------------------+
| -i     | 使top不显示任何闲置或者僵死进程                                                                  |
+--------+--------------------------------------------------------------------------------------------------+
| -c     | 显示整个命令行而不只是显示命令名                                                                 |
+--------+--------------------------------------------------------------------------------------------------+
| -n num | 刷新次数，-n 1表示只显示一次就退出                                                               |
+--------+--------------------------------------------------------------------------------------------------+

交互命令
-----------
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  命令  |                                                                                                                                                                                         说明                                                                                                                                                                                         |
+========+======================================================================================================================================================================================================================================================================================================================================================================================+
| h或者? | 显示帮助画面，给出一些简短的命令总结说明                                                                                                                                                                                                                                                                                                                                             |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| k      | 终止一个进程。系统将提示用户输入需要终止的进程PID，以及需要发送给该进程什么样的信号。一般的终止进程可以使用15信号；如果不能正常结束那就使用信号9强制结束该进程。默认值是信号15。在安全模式中此命令被屏蔽                                                                                                                                                                             |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| i      | 忽略闲置和僵死进程。这是一个开关式命令                                                                                                                                                                                                                                                                                                                                               |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| I      | Solaris模式和Irix模式。**Solaris**将所有处理器作为一个整体，无论服务器有多少处理器，cpu的总使用率始终为0％到100％。也就是说，如果Solaris服务器具有N个处理器，则单个进程最多只能消耗高达（100 / N）％的总体CPU使用率。**Irix模式**，这是Linux上的默认模式，最大的cpu使用总量是cpu总数的总和，不再像Solaris模式那样固定为1（100％）。因此，启用Irix模式后，单个进程最多可以达到100％。 |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| q      | 退出程序                                                                                                                                                                                                                                                                                                                                                                             |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| r      | 重新安排一个进程的优先级别。系统提示用户输入需要改变的进程PID以及需要设置的进程优先级值。输入一个正值将使优先级降低，反之则可以使该进程拥有更高的优先权。默认值是10。                                                                                                                                                                                                                |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| S      | 切换到累计模式                                                                                                                                                                                                                                                                                                                                                                       |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| s      | 改变两次刷新之间的延迟时间。系统将提示用户输入新的时间，单位为s。如果有小数，就换算成m s。输入0值则系统将不断刷新                                                                                                                                                                                                                                                                    |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| f或者F | 从当前显示中添加或者删除列。                                                                                                                                                                                                                                                                                                                                                         |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| o或者O | 改变显示列的顺序                                                                                                                                                                                                                                                                                                                                                                     |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| l      | 切换是否显示平均负载和启动时间信息。                                                                                                                                                                                                                                                                                                                                                 |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c      | 切换显示命令名称和完整命令行。                                                                                                                                                                                                                                                                                                                                                       |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| M      | 根据驻留内存大小进行排序。                                                                                                                                                                                                                                                                                                                                                           |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| m      | 切换内存信息显示形式。                                                                                                                                                                                                                                                                                                                                                               |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| P      | 根据CPU使用百分比大小进行排序。                                                                                                                                                                                                                                                                                                                                                      |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| T      | 根据时间/累计时间进行排序。                                                                                                                                                                                                                                                                                                                                                          |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| t      | 切换显示进程和CPU状态信息。                                                                                                                                                                                                                                                                                                                                                          |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| E      | 切换系统内存显示单位（K/M/G)                                                                                                                                                                                                                                                                                                                                                         |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| e      | 切换每个进程内存显示单位（K/M/G)                                                                                                                                                                                                                                                                                                                                                     |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
